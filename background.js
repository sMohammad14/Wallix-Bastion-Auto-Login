function setIconBasedOnState(){chrome.storage.local.get(['enabled'],(result)=>{const isEnabled=result.enabled===true;const iconPath=isEnabled?{16:"icons/icon-color-16.png",32:"icons/icon-color-32.png",48:"icons/icon-color-48.png",128:"icons/icon-color-128.png"}:{16:"icons/icon-gray-16.png",32:"icons/icon-gray-32.png",48:"icons/icon-gray-48.png",128:"icons/icon-gray-128.png"};chrome.action.setIcon({path:iconPath}).catch(error=>{});});}chrome.runtime.onInstalled.addListener(()=>{chrome.storage.local.get(['enabled'],(result)=>{if(result.enabled===undefined){chrome.storage.local.set({enabled:false});}setIconBasedOnState();});});chrome.storage.onChanged.addListener((changes,area)=>{if(area==='local'&&changes.enabled){setIconBasedOnState();}});chrome.runtime.onMessage.addListener((request,sender,sendResponse)=>{if(request.action==="GET_STATUS"){chrome.storage.local.get(['enabled'],(result)=>{sendResponse({enabled:result.enabled});});return true;}});
